' Red Ink Shared Library
' Copyright by David Rosenthal, david.rosenthal@vischer.com
' May only be used under with an appropriate license (see vischer.com/redink)
'
' The compiled version of Red Ink also ...
'
' Red Ink for Word
' Copyright by David Rosenthal, david.rosenthal@vischer.com
' May only be used under the Red Ink License. See License.txt or https://vischer.com/redink for more information.
'
' 15.12.2025
'
' The compiled version of Red Ink also ...
'
' Includes DiffPlex in unchanged form; Copyright (c) 2023 Matthew Manela; licensed under the Apache-2.0 license (http://www.apache.org/licenses/LICENSE-2.0) at GitHub (https://github.com/mmanela/diffplex).
' Includes Newtonsoft.Json in unchanged form; Copyright (c) 2023 James Newton-King; licensed under the MIT license (https://licenses.nuget.org/MIT) at https://www.newtonsoft.com/json
' Includes HtmlAgilityPack in unchanged form; Copyright (c) 2024 ZZZ Projects, Simon Mourrier,Jeff Klawiter,Stephan Grell; licensed under the MIT license (https://licenses.nuget.org/MIT) at https://html-agility-pack.net/
' Includes Bouncycastle.Cryptography in unchanged form; Copyright (c) 2024 Legion of the Bouncy Castle Inc.; licensed under the MIT license (https://licenses.nuget.org/MIT) at https://www.bouncycastle.org/download/bouncy-castle-c/
' Includes PdfPig in unchanged form; Copyright (c) 2024 UglyToad, EliotJones PdfPig, BobLd; licensed under the Apache 2.0 license (https://licenses.nuget.org/Apache-2.0) at https://github.com/UglyToad/PdfPig
' Includes MarkDig in unchanged form; Copyright (c) 2024 Alexandre Mutel; licensed under the BSD 2 Clause (Simplified) license (https://licenses.nuget.org/BSD-2-Clause) at https://github.com/xoofx/markdig
' Includes NAudio and components in unchanged form; Copyright (c) 2020 Mark Heath; licensed under a proprietary open source license (https://www.nuget.org/packages/NAudio/2.2.1/license) at https://github.com/naudio/NAudio
' Includes Vosk in unchanged form; Copyright (c) 2022 Alpha Cephei Inc.; licensed under the Apache 2.0 license (https://licenses.nuget.org/Apache-2.0) at https://alphacephei.com/vosk/
' Includes Whisper.net in unchanged form; Copyright (c) 2024 Sandro Hanea; licensed under the MIT license (https://licenses.nuget.org/MIT) at https://github.com/sandrohanea/whisper.net
' Includes Grpc.core/Grpc.net in unchanged form; Copyright (c) 2023/2025 The gRPC Authors; licensed under the Apache 2.0 license (https://licenses.nuget.org/Apache-2.0) at https://github.com/grpc/grpc
' Includes Google Speech V1 library and related API libraries in unchanged form; Copyright (c) 2024 Google LLC; licensed under the Apache 2.0 license (https://licenses.nuget.org/Apache-2.0) at https://github.com/googleapis/google-cloud-dotnet
' Includes Google Protobuf in unchanged form; Copyright (c) 2025 Google Inc.; licensed under the BSD-3-Clause license (https://licenses.nuget.org/BSD-3-Clause) at https://github.com/protocolbuffers/protobuf
' Includes Google.Api in unchanged form; Copyright (c) 2025 Google LLC; licensed under the BSD-3-Clause license (https://licenses.nuget.org/BSD-3-Clause) at https://github.com/googleapis/gax-dotnet
' Includes Google.Apis in unchanged form; Copyright (c) 2025 Google LLC; licensed under the Apache 2.0 license (https://licenses.nuget.org/Apache-2.0) at https://github.com/googleapis/google-api-dotnet-client
' Includes Google.Longrunning in unchanged form; Copyright (c) 2025 Google LLC; licensed under the Apache 2.0 license (https://licenses.nuget.org/Apache-2.0) at https://github.com/googleapis/google-cloud-dotnet
' Includes MarkdownToRTF in modified form; Copyright (c) 2025 Gustavo Hennig; original licensed under the MIT license (https://licenses.nuget.org/MIT) at https://github.com/GustavoHennig/MarkdownToRtf
' Includes Nito.AsyncEx in unchanged form; Copyright (c) 2021 Stephen Cleary; licensed under the MIT license (https://licenses.nuget.org/MIT) at https://github.com/StephenCleary/AsyncEx
' Includes NetOffice libraries in unchanged form; Copyright (c) 2020 Sebastian Lange, Erika LeBlanc; licensed under the MIT license (https://licenses.nuget.org/MIT) at https://github.com/netoffice/NetOffice-NuGet
' Includes NAudio.Lame in unchanged form; Copyright (c) 2019 Corey Murtagh; licensed under the MIT license (https://licenses.nuget.org/MIT) at https://github.com/Corey-M/NAudio.Lame
' Includes PdfiumViewer in unchanged form; Copyright (c) 2017 Pieter van Ginkel; licensed under the Apache 2.0 license (https://licenses.nuget.org/Apache-2.0) at https://github.com/pvginkel/PdfiumViewer
' Includes PDFsharp in unchanged form; Copyright (c) 2025 PDFSharp Team; licensed under the MIT license (https://licenses.nuget.org/MIT) at https://docs.pdfsharp.net/
' Includes System.Interactive.Async in unchanged form; Copyright (c) 2025 by .NET Foundation and Contributors; licensed under the MIT license (https://licenses.nuget.org/MIT) at https://github.com/dotnet/reactive
' Includes also various Microsoft distributables and libraries copyrighted by Microsoft Corporation and available, among others, under the Microsoft EULA and the MIT License (including Microsoft.Bcl.*, Microsoft.Extensions.*, System.*, System.Security.*, System.CodeDom, DocumentFormat.OpenXml.*, Microsoft.ml.*, CommunityToolkit.HighPerformance licensed under MIT License) (https://licenses.nuget.org/MIT); Copyright (c) 2016- Microsoft Corp.'
'
' Documentation see at the end of this file.
' '
' Documentation see at the end of this file.
' The documentation of the individual files is still ongoing and will be completed (as has been done for the Excel and Outlook add-ins) by the end of the beta test.
'
'
' =============================================================================
' Red Ink Shared Library - Architectural Overview
'
' Purpose:
'   Central reusable components for Office add-ins and AI-assisted document features:
'   text processing, embeddings, anonymization, UI, configuration, and model orchestration.
'
' Subsystems:
'
' [Core\Clipboard]
'   NativeClipboard.vb              - P/Invoke wrappers for Win32 clipboard operations.
'   ClipboardHelper.vb              - High-level helper (safe open/close, format handling).
'   SharedMethods.ClipboardSnapshot - Capture current clipboard contents into a serializable snapshot.
'   SharedMethods.PutInClipboard    - Put structured content safely.
'   SharedMethods.StoreAndRestoreClipboard - RAII-style state preservation.
'
' [Core\Config]
'   SharedMethods.LoadConfig        - Reads config from disk/environment.
'   SharedMethods.Settings          - Strongly-typed settings accessors and defaults.
'
' [Core\LLM]
'   ModelConfig / ModelSelectorForm / MultiModelSelectorForm - UI + models metadata.
'   SharedMethods.MainLLM           - Primary orchestration for model invocation.
'   SharedMethods.AlternateModels   - Fallback / multi-model strategy.
'   JsonTemplateFormatter           - Ensures structured JSON output.
'   MimeHelper                      - MIME classification for assets.
'   ImageDecoder                    - Convert embedded images to suitable analysis forms.
'   SharedMethods.GoogleOAuthHelper - OAuth token handling.
'   SharedMethods.Signing           - Cryptographic signing operations.
'
' [Core\Texthandling]
'   SharedMethods.TextHandling      - Normalization, segmentation, cleaning.
'   SharedMethods.TextHandlingExcel - Excel-specific cell / range extraction.
'   SharedMethods.Diff              - Diff operations built atop DiffPlex.
'
' [Core\UI]
'   ProgressForm / ProgressBarModule / DPIProgressForm - Unified progress UI.
'   SharedMethods.Infobox           - User messages (info/warn/error).
'   SharedMethods.Pane              - Docked pane logic.
'   SelectionFormSmall              - Lightweight selection dialog.
'   SharedMethods.SplashScreen / SplashScreenWorks / SplashScreenCountDown - Startup visuals.
'   ShowMethods.CustomForms         - Custom dynamic forms.
'
' [Core\Various]
'   SharedMethods.FileImporter      - File ingestion pipeline.
'   SharedMethods.ProcessParameterPlaceholders - Placeholder expansion in user text.
'   SharedMethods.VarHelpers        - Generic variable utilities.
'
' [CommonFeatures\Embeddings]
'   EmbeddingStore                  - Persistence and retrieval of embeddings.
'   EmbeddingStore_BagOfWords       - Simple vectorization fallback.
'   MlNetTokenizer                  - Token splitting using ML.NET facilities.
'   OnnxAnonymizer                  - ONNX-based entity redaction before embeddings.
'   TextChunk / TokenOffset / SearchResult - Data models for chunking & search ranking.
'
' [CommonFeatures]
'   AnonymizationModule             - Top-level anonymization workflow coordinator.
'   HelpMeInky                      - Prompt assistance utilities.
'   SharedMethods.MyStyleHelpers    - Styling helpers (fonts/colors/themes).
'   SharedMethods.PromptLibrary     - Reusable LLM prompt templates.
'   SharedMethods.TextFileEditor    - Text file manipulation operations.
'   UpdateHandler                   - Update checking and application.
'   WebAgentInterpreter             - Instruction parsing for automated web tasks.
'
' [InstallationWizard]
'   InitialConfig / AppConfigurationVariable - First-run setup and variable binding.
'
' [Interop]
'   WinAPI / WindowsWrapper / NativeMethods - Managed wrappers and constants for Windows APIs.
'
' [Definitions]
'   SharedContext                   - Cross-cutting context (environment, user session).
'   SharedMethods.Constants         - Application-wide constant values.
'
' [Converter]
'   MarkdownToRtfConverter          - Modified upstream library (document modifications inline).
'
' Add-ins (Word/Excel/Outlook)
'   ThisAddIn.*                     - Host integration entry points.
'
' External Libraries:
'   See license section below (retain original notices; list any modifications explicitly).
'
' Thread-Safety Summary:
'   Most modules stateless; EmbeddingStore and UpdateHandler manage state (guard with locks).
'
' Logging:
'   (Document the logging framework/module here if present.)
'
' Security Considerations:
'   Signing + OAuth modules handle credential/token flows. Secrets must not be persisted in plain text.
'
