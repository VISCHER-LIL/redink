; Sample Configuration file for Red Ink 
; 
; For more model configurations see allmodels.ini and the other sample file
; For a full overview of the parameters and information on how to implement centralized configurations in networks, see the documentation available at https://redink.ai
;
; December 30, 2025

; ------------------------------------------------------------------
; Model Config (primary model, secondary model using *_2 suffix))
; ------------------------------------------------------------------

; Sample entry for OpenAI API
;
; If APIKeyEncrypted = Yes, Red Ink will decode the APIKey here using the secret value built into the code or stored in the registry; the APIKeyPrefix must specify the correct standard prefix, if there is one

APIKey = [[Your API Key]]
APIKeyEncrypted = False
APIKeyPrefix = sk-proj-
Endpoint = https://api.openai.com/v1/chat/completions
HeaderA = Authorization
HeaderB = Bearer {apikey}
Response = content
APICall = {"model": "{model}",  "messages": [{"role": "system","content": "{promptsystem}"},{"role": "user","content": [{ "type": "text", "text": "{promptuser}"}{objectcall}]}],"temperature": {temperature}}
APICall_Object = , {"type": "image_url", "image_url": {"url": "data:{mimetype};base64,{encodeddata}"}}
Timeout = 500000
Temperature = 1.0
Model = gpt-5.1

; If a second model is to be made available, it must also be configured; then SecondAPI = Yes must be set; it can be accessed via Freestyle

SecondAPI = True

; Sample entry for Google Vertex API
; Here configured to be used as the secondary model; it it shall be the primary one, remove the "_2"
;
; Google Vertex uses the OAuth2.0 mechanism, which is more complicated. The APIKey contains the Private Key to obtain an access token (encrypted or unencrypted). 

APIKey_2 = [[Your Secret Key]]
APIKeyEncrypted_2 = False
APIKeyPrefix_2 =
Model_2 = gemini-2.5-pro
Endpoint_2 = https://europe-west4-aiplatform.googleapis.com/v1/projects/[[Your Project ID]]/locations/europe-west4/publishers/google/models/{model}:generateContent
HeaderA_2 = Authorization
HeaderB_2 = Bearer {apikey}
Response_2 = text
APICall_2 = {"contents": [{"role": "user", "parts":[{"text": "{promptsystem} {promptuser}"}{objectcall}]}], "generationConfig": {"temperature": {temperature}}}
APICall_Object_2 = , {"inlineData": {"mimeType": "{mimetype}","data": "{encodeddata}"}}
OAuth2_2 = True
OAuth2ClientMail_2 = [[Your Account Mail]]
OAuth2Scopes_2 = https://www.googleapis.com/auth/cloud-platform
OAuth2Endpoint_2 = https://oauth2.googleapis.com/token
OAuth2ATExpiry_2 = 3600
Timeout_2 = 200000
Temperature_2 = 0.2

; ------------------------------------------------------------------
; Additional Models And Services Parameters
; ------------------------------------------------------------------

; Path for configuration file for additional "alternate" models (entries have the same format as above, plus section headers [modelname....])
AlternateModelPath = %APPDATA%\microsoft\word\allmodels.ini

; Path for configuration file for special service JSON REST APIS (entries have the same format as above, plus section headers [modelname....])
SpecialServicePath = %APPDATA%\microsoft\word\specialservices.ini

; Directory where local speech models are stored for transcription
SpeechModelPath = D:\RedInk\Speech

; Endpoint(s) for text-to-speech services (Google TTS and OpenAI); separate multiple endpoints with "¦"
TTSEndpoint = https://texttospeech.googleapis.com/v1/¦https://api.openai.com/v1/audio/speech

; ------------------------------------------------------------------
; Advanced API parameters (optional / provider-specific)
; ------------------------------------------------------------------

; Can be usd to turn on the on-the-fly anonymization for a model and configure it.
Anon =
Anon_2 =

; Optional token counting configuration (provider-specific), will generate a log.
TokenCount =
TokenCount_2 =

; Set the maximum output lenght in tokens (provider-specific) to warn user if likely to be exceeded
MaxOutputToken = 128000
MaxOutputToken_2 =

; ------------------------------------------------------------------
; General Parameters For Processing processing LLM results
; ------------------------------------------------------------------

; DoubleS decides whether the sharp S is converted into "ss"

DoubleS = True

; PostCorrection is a standard prompt that is applied as an additional query to the result of many functions (this extends the query and costs time)
PostCorrection = 

; If True, tries to return a "clean" result (remove invisible characters, double spaces)
Clean = True

; If True, converts em dashes to simpler dash variants where applicable.
NoEmDash = False

; ------------------------------------------------------------------
; General parameters to refine the input to LLMs
; ------------------------------------------------------------------

; PreCorrection is a standard prompt that is included with each query (e.g., to automatically correct content) - usually left empty
PreCorrection = 

; If True, applies the built-in "ignore" prompt (SP_Ignore) to protect against prompt injections
Ignore = False

; If set, this text will be passed as part of a number of system prompts, e.g., for Freestyle and Chat prompts to make the LLM location aware
Location = We are in Zurich, Switzerland.

; ------------------------------------------------------------------
; General Application Parameters
; ------------------------------------------------------------------

; Max characters allowed in Chat-style operations (Word/Excel chat, etc.).
ChatCap = 80000

; You can have key shortcuts added to the commands in the Word and Excel context menu, in addition to the normal menu; to use this, cite the command and the combination); if you want AltGR, use Ctrl-Alt; for this to work, you also need to install the additional helper file in Word and Excel (can be done through Settings)
ContextMenu = True
ShortcutsWordExcel = To English=Ctrl-Shift-Y;To German=Ctrl-Shift-X;Freestyle=Ctrl-Shift-C;Self-compare selection=Ctrl-Alt-C

; If selected, then the data sent to and received from the API will written into a file RI_Debug.txt on the desktop of the user (no API Key)
APIDebug = False

; You can use this to configure the one or two menu entries that allow the direct access to the translator for the respective language (default is English and German)
Language1 = English
Language2 = German

; You can enter a text that appears in Outlook when users hover over the Red Ink logo, for instance for advising them of usage restrictions re Red Ink
UsageRestrictions = You may use Red Ink for personal data, but not for confidential client data

; The source where the Help Me, Inky chatbot will get its "knowledge" (can be TXT, PDF or Docx)
HelpMeInkyPath = https://redink.ai/apps/ga/Red_Ink_Guide.txt

; ------------------------------------------------------------------
; General Update Options
; ------------------------------------------------------------------

; With this, you can control how often each installation of Red Ink will check via https://redink.ai whether there is a new version and offer to install it; will also trigger INI updates, if configured; UpdatePath is only required for local copies of the installation files
UpdateCheckInterval = 7
UpdatePath = 

; ------------------------------------------------------------------
; INI self-update (optional)
; ------------------------------------------------------------------

; If Yes, Red Ink may update the INI from a configured source (URL, filepath, UNC).
UpdateIni = True

; If Yes, allows UpdateSource to be a remote URL.
UpdateIniAllowRemote = True

; If Yes, skips signature verification (not recommended).
UpdateIniNoSignature = False

; Where to update from.
; Format: UpdateSource = path; keys; publicKey
;  - path: local file, UNC path, or https:// URL (URL only if UpdateIniAllowRemote=Yes)
;  - keys: REQUIRED. One of:
;       all                 = update all keys present in update file
;       new                 = only propose keys that don't exist locally
;       Key1,Key2           = only those keys
;       -Key1               = exclude a key (combine with all/new or key list)
;       combinations allowed: all,-APIKey,-APIKey_2 or Endpoint,Model,new
;  - publicKey: optional Base64 Ed25519 public key. If provided and UpdateIniNoSignature=No
;       then a .sig file must exist next to the update file (same URL/path + ".sig").
UpdateSource =

; List of keys that must not be overridden by an INI update, even if they are on the internal ignore list because the user skipped them in the past (in interactive setups); see documentation for details.
UpdateIniIgnoreOverride = 

; Silent mode level (0=off=interactive mode; higher values enable more automatic behavior).
UpdateIniSilentMode = 0

; If Yes, writes a log for silent INI updates.
UpdateIniSilentLog = True

; If you set any client names, only they will be able to run updates (comma-separated, case-insensitive); leave empty to allow all clients; use "clientname" in Freestyle to get the actual client name
UpdateClients =

; ------------------------------------------------------------------
; Markup and Formatting Options
; ------------------------------------------------------------------

; You can control whether Outlook and certain Word functions should automatically create a markup for certain functions and you can control which markup methods are to be used within Word (Helpers, Other functions) and Outlook; the methods are 1 = Word, 2 = Diff, 3 = DiffW and 4 = Regex (Outlook does not support Regex); you can limit the number of characters for which certain markup methods are used (for Diff, Regex)
DoMarkupOutlook = True
DoMarkupWord = True
MarkupMethodHelper = 3
MarkupMethodWord = 3
MarkupMethodOutlook = 3
MarkupDiffCap = 30000
MarkupRegexCap = 40000

; If Yes, converts character formatting (basic formatting properties such as bold, italic, underline, highlightcolor) into Markdown format in the output text to preserve.
MarkdownConvert = True

; If Yes, preserves paragraph formatting by including an inline reference to the paragraph style (first try without this; Red Ink tries to do the same in a less sophisticated mode by default).
KeepParaFormatInline = False

; If set to yes, then Red Ink will try to apply basic formatting elements of the selected text to the output of the AI; no. 1 relates to the translation functions, no. 2 to the other preprogrammed functions
KeepFormat1 = False
KeepFormat2 = False

; If set to yes, then Red Ink will have the selected text replaced by the output of the AI, instead of inserting it after the selected text; no. 1 relates to the translation functions, no. 2 to the other preprogrammed functions
ReplaceText1 = True
ReplaceText2 = True

; Upper character limit where KeepFormat processing is attempted.
KeepFormatCap = 30000

; If Yes, bubble markups are provided with formatting (where supported by the LLM)
MarkdownBubbles = False

; ------------------------------------------------------------------
; Additional Resource Paths (Used By Special Features)
; ------------------------------------------------------------------

; We recommend to use the Word directory also for Excel and Outlook files, as Excel and Outlook share the redink.ini file of Word (unless they have their own)

; Path to the central and local prompt library file (in a purely local installation, use the central parameter)
PromptLib = %APPDATA%\microsoft\word\promptlib.txt
PromptLibLocal =

; Path to the prompt library used by the transcriptor
PromptLib_Transcript = %APPDATA%\microsoft\word\promptlib_transcript.txt

; The style file used for storing the user's writing style (as analyzed by Red Ink); should be a local file; it is used to apply the style in other contexts
MyStylePath = %APPDATA%\microsoft\word\mystyle.txt

; Directory for local AI models (e.g., for embedding store search); local speech models have a separate directory setting.
LocalModelPath =

; Directories (central and local) for the Web agent, Find Clause, DocCheck, DocStyle, PDF redaction functions (Word); the functions will look in this directory for prompt libraries/resources
WebAgentPath = %APPDATA%\microsoft\word 
WebAgentPathLocal = 
FindClausePath = %APPDATA%\microsoft\word
FindClausePathLocal =
DocCheckPath = %APPDATA%\microsoft\word
DocCheckPathLocal =
DocStylePath = %APPDATA%\microsoft\word
DocStylePathLocal =

; Path (central and local) for the PDF redaction function (Word); this file contains the predefined redaction prompts
RedactionInstructionsPath = %APPDATA%\microsoft\word\redactionlib.txt
RedactionInstructionsPathLocal = 

; Path (central and local) for the Discuss Inky function (Word); this file contains the predefined persona prompts
DiscussInkyPath = %APPDATA%\microsoft\word\personalib.txt
DiscussInkyPathLocal = %APPDATA%\microsoft\word\personaliblocal.txt

; Path (central and local) for the Data Extractor and File Rename function (Excel); this file contains the predefined instructions
ExtractorPath = %APPDATA%\microsoft\word\extractorlib.txt
ExtractorPathLocal =
RenameLibPath = %APPDATA%\microsoft\word\renamelib.txt
RenameLibPathLocal =

; ------------------------------------------------------------------
; Parameters for Local RAG (Library, triggered by "(lib)"
; ------------------------------------------------------------------

; If library search is to be enabled when using Freestyle (you will need to specify a library file to be used and amend the prompts as applicable); below, sample actual prompts have been commented out because if you do not provide them, Red Ink will use the standard prompts (if you provide them, Red Ink will use those instead)
Lib = True
Lib_File = %APPDATA%\microsoft\word\library.txt
Lib_Timeout = 30000

; The file library.txt should contain on each line an entry such as this one (you can change the format, but then you need to change below prompts, too): {"text": "Defined Terms\nCapitalized terms used in this Agreement shall have the meaning assigned to such terms in Annex 1."}

;Lib_Find_SP = You are a legal professional with very good legal, language and logical skills and text handling capabilities, and you precisely comply with any instructions step by step. You are given an instruction from the user: {OtherPrompt}. If present, the user also provides text between <TEXTTOPROCESS> and </TEXTTOPROCESS>. A library of JSON objects with content of the user that can help you fulfill your task is included between <LIBRARY> and </LIBRARY>, one object per line, each with a field "text". Identify and return only the values of "text" from those library elements that you believe will help you complying with the user’s instruction. If multiple elements apply, separate them with '---'. If no elements apply, return an empty result. Return only the applicable library texts, without any commentary or explanation. <LIBRARY>{LibraryText}</LIBRARY>
;Lib_Apply_SP = You are a legal professional with very good legal, language and logical skills and text handling capabilities, and you precisely comply with any instructions step by step. You have the following instruction: {OtherPrompt}. For performing the instruction, rely as much as possible on the substantive content you are provided between the tags <LIBRESULT> and </LIBRESULT>. (If multiple library elements apply, they are separated by '---'.) Use all library elements intelligently to comply with the user’s instruction, such as drafting a clause. Create a suitable text from scratch, using the library elements and the instruction; use your own skills to combine them intelligently. Stick in all substantive aspects to the material contained in LIBRESULT, as this is the user's preferred library (i.e. do not revert to any other substantive information). If the library contains not enough information, say so. Present a clean, final version of the text without markup or extra commentary. If the library contains conflicting information, you may offer alternatives, provided they are marked as such (for example by offering two alternative wordings within a clause, "seller friendly:" and "buyer friendly"), but check out the instruction to determine whether it will tell you which alternative the user is looking for.\n<LIBRESULT>{LibResult}</LIBRESULT>
;Lib_Apply_SP_Markup = You are a legal professional with very good legal, language and logical skills and text handling capabilities, and you precisely comply with any instructions step by step. You have the following instruction: {OtherPrompt}. For performing the instruction, rely as much as possible on the substantive content you are provided between the tags <LIBRESULT> and </LIBRESULT>. (If multiple library elements apply, they are separated by '---'.) The user’s existing text that you need to modify on the basis of your instruction is provided to you between <TEXTTOPROCESS> and </TEXTTOPROCESS>. Use all library elements intelligently to comply with the user’s instruction, such as improving or amending the existing clauses of the user. Stick in all substantive aspects to the material contained in LIBRESULT, as this is the user's preferred library (i.e. do not revert to any other substantive information). If the library contains not enough information, say so at the end of the text in a remark contained in square brackets. Present a clean, final version of the text without markup or extra commentary. If the library contains conflicting information, you may offer alternatives, provided they are marked as such (for example by offering two alternative wordings within a clause, "seller friendly:" and "buyer friendly"), but check out the instruction to determine whether it will tell you which alternative the user is looking for.\n<LIBRESULT>{LibResult}</LIBRESULT>

; ------------------------------------------------------------------
; Parameters for Local Search Grounding (triggered by "(net)")
; ------------------------------------------------------------------

; If the built-in Internet search shall be available, configure it for example as follows (note that most modern LLMs today offer a much faster and more efficient Internet search "grounding")
ISearch = True
ISearch_URL = https://duckduckgo.com/html/?q=
ISearch_ResponseMask1 = duckduckgo.com/l/?uddg=
ISearch_ResponseMask2 = &
ISearch_Name = DuckDuckGo
ISearch_Tries = 4
ISearch_MaxDepth = 2
ISearch_Results = 2
ISearch_Approve = False

ISearch_Timeout = 30000

; Optional: prompt templates for search term extraction and application
; (If not provided, code uses built-in defaults.)
;ISearch_SearchTerm_SP =
;ISearch_Apply_SP =
;ISearch_Apply_SP_Markup =

; ------------------------------------------------------------------
; License Management Parameters
; ------------------------------------------------------------------

; LicensedTill:
;   - If set to a valid date, it is treated as a centrally managed license end date.
;     If expired, the add-in is disabled (except during the grace period defined in code).
;   - If set to "False" or "No" (case-insensitive), license checks are DISABLED (fail-open).
;   - If set to a date far in the future (beyond internal threshold), checks may be disabled as well.
;   Recommended format: YYYY-MM-DD (culture-invariant-ish), e.g. 2026-12-31
LicensedTill = 2026-12-31

; Optional human-readable license type/status shown in UI (used when license is read from config).
; Example: "Pro License", "Transition Pro", "Beta Test License", etc.
LicenseStatus = Pro License

; Optional number of licensed users (integer). Used for display (and persisted if from config).
LicenseUsers = 25

; Optional contact line appended to license warning/expiry messages.
; Example: "For renewals contact IT: it@company.com"
LicenseContact = Contact IT for license renewals: it@yourcompany.com

; If True, suppresses license expiry / grace period warnings (does not bypass hard expiry if LicensedTill is from config).
LicenseNoWarning = False

; ------------------------------------------------------------------
; Prompt Overrides
; ------------------------------------------------------------------

; You can change almost any system prompt by providing it here; if you leave it empty, Red Ink will use the built-in standard prompt for the respective function; prompts can use {placeholders} that Red Ink will replace when using the prompt; see the documentation for details

; Exmample:
;SP_Translate = "You are a translator that precisely complies with its instructions step by step. Translate in to {TranslateLanguage} the text that is provided to you and is marked as 'Texttoprocess'. When you translate, do not add any other comments and the translation should be of about the same length. Whenever there is a line feed or carriage return in text provided to you, it is essential that you also include such line feed or carriage return in the output you generate. The carriage returns and line feeds in the output must match exactly those in the original text provided to you. Accordingly, if there are two carriage returns or line feeds in succession in the text provided to you, there must also be two carriage returns or line feeds in the text you generate. Remove any double spaces that follow punctuation marks. Before translating, check whether the text is drafted in a formal or informal manner, and maintain such style. If and when asked to translate to a language where the translation of 'you' is translated differently depending on whether it is formal or not, such as German or French, go by default for a formal translation (e.g., 'Sie' or 'vous'), unless the text is clearly very informal, for example, because the text is addressed to a person by their first name or signed only with the first name of a person. {Ignore} {INI_PreCorrection}"

